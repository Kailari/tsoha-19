{% extends "layout.html" %}

{% block body %}
<h1>{{ user.name }}'s Wall</h1>

<div class="card mb-2">
  <form method="POST" action="{{ url_for('user_wall', user_id=user.id) }}" novalidate>
    <div class="form-group mb-0">
      <label class="form-label card-header" style="width: 100%" for="newContent">
        <h5>Create new post
          <button type="submit" class="btn btn-primary float-sm-right">Create Post</button>
        </h5>
      </label>
      <div class="card-body p-0">
        <textarea class="form-control" name="content" id="newContent" placeholder="How's your day?" rows="3"
          aria-describedby="newContentHelp" required></textarea>
        <small id="newContentHelp" class="form-text text-muted sr-only">
          Contents of your post. e.g. How was your day?
        </small>
      </div>
      {% if form.content.errors %}
      <div class="alert alert-danger mb-0 py-1" role="alert">
        {% for error in form.content.errors %}
        {{ error }}<br />
        {% endfor %}
      </div>
      {% endif %}
    </div>
    <div class="form-group mb-0">

    </div>
  </form>
</div>

<h2>Posts</h2>
<div>
  {% for post in posts %}
  <div class="card mb-2">
    <h5 class="card-header">
      {{ post.poster_name }}
      <small class="text-muted float-sm-right">
        {{ timeago_format(post.date_created) }}
      </small>
    </h5>
    <div class="card-body">
      <p class="card-text">
        {{ post.content }}
      </p>
    </div>
  </div>
  {% endfor %}
</div>
<div>
  <div class="overlay" onclick="backToTop()">
    <span class="text-white">Back to top</span>
  </div>
  <div class="text-center">
    <hr>
    <span class="text-muted">No more posts :c</span>
    <hr>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  var sizeTheOverlays = function () {
    $(".overlay").resize().each(function () {
      var h = $(this).parent().outerHeight();
      var w = $(this).parent().outerWidth();
      $(this).css("height", h);
      $(this).css("width", w);
    });
  };

  sizeTheOverlays();

  var width = $(window).width();
  $(window).resize(function () {
    if ($(this).width() != width) {
      width = $(this).width();
      sizeTheOverlays();
    }
  });

  function backToTop() {
    document.body.scrollTop = 0
    document.documentElement.scrollTop = 0
  }
</script>
{% endblock %}